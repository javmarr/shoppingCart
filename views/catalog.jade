extends layout
// Page Content
block content
  div.container
    div.row
      div.col-lg-12.text-center
        h1=title

    if (success)
      p(style="color: green")=success
    
    if (error)
      p(style="color: red")=error
    
    if isAdmin
      a(href="/addItem" class="btn btn-success btn-sm") Add Item
      
      form(action="" method="post")
        p show hidden items?  
          if (show)
            input(type='checkbox', name='showHidden' checked)
          else
            input(type='checkbox', name='showHidden')
        br
        br
        input(type='submit', value='Filter')
      
    table(class="table table-striped table-hover")
      tr
        if isAdmin
          th
        th
        th isbn
        th name
        th author
        th genre
        if isAdmin
          th cost
        th price
        th library
        if isAdmin
          th show
          th numberInStock
        
      each item in items
        tr
          if isAdmin
            td
              button(class="btn btn-danger removeButton" id="#{item.id}") delete
          td(class="showDetails" id="#{item.id}")
            img(src="#{item.image}" id="#{item.id}" width="75px" height="112px")
          td(class="showDetails" id="#{item.id}") #{item.isbn}
          td(class="showDetails" id="#{item.id}") #{item.name}
          td(class="showDetails" id="#{item.id}") #{item.author}
          td(class="showDetails" id="#{item.id}") #{item.genre}
          if isAdmin
            td(class="showDetails" id="#{item.id}") #{item.cost}
          td(class="showDetails" id="#{item.id}") #{item.price}
          td(class="showDetails" id="#{item.id}") #{item.library}
          if isAdmin
            td(class="showDetails showItem" id="#{item.id}") #{item.show}
            td(class="showDetails" id="#{item.id}") #{item.numberInStock}

    br
    a(href="/" class="btn btn-default btn-block") Back
    
    script.
      $(document).ready( function () {
        //- var $(".showItem")
        
        $(".showDetails").click(function (e) {
          console.log("showing details for: " + e.target.id);
          window.document.location = "item/"+e.target.id;          
        });
        
        //- $(".removeButton").click(function (e) {
        $(".removeButton").click(function (e) {
           console.log("removing: " + e.target.id);
          $.get( "removeItem/"+e.target.id, function( data ) {
            console.log("received: " + data);
            location.reload();
          });
        });
      });
